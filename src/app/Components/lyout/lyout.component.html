<mat-toolbar>
    <mat-toolbar-row class="toolbar">
        <div class="toolbar-start">
            <span>Chat App</span>
        </div>
      <div class="toolbar-end">
        <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
            <mat-icon>person_circle</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item>
              <mat-icon>account_circle</mat-icon>
              <span>{{Me?.username}}</span>
            </button>
            <button mat-menu-item (click)="openDialogWithRef(resetPasswordDialog)">
                <mat-icon>lock_reset</mat-icon>
                <span>Reset password</span>
            </button>
            <button mat-menu-item (click)="logout()">
              <mat-icon>logout</mat-icon>
              <span>Log out</span>
            </button>
          </mat-menu>
      </div>
    </mat-toolbar-row>
</mat-toolbar>
<mat-drawer-container class="example-container drawer-container">
    <mat-drawer mode="side" opened class="drawer-container-menu">

        <mat-list-item matListItemTitle>
            <span matLine class="menu-title">
                <mat-icon class="menu-title-icon">menu</mat-icon>
                Menus
            </span>
        </mat-list-item>
        <ng-container>
            @for(menu of menus; track menu) {
                <mat-list-item matLine (click)="navigateToRoute(menu.path)" matListItemLine class="menu-item">
                    {{menu.label }}
                </mat-list-item>
            }
        </ng-container>
    </mat-drawer>

    <mat-drawer-content class="drawer_content">
        <router-outlet></router-outlet>
    </mat-drawer-content>
    
</mat-drawer-container>

<!-- Template to reinitialize password -->
<ng-template #resetPasswordDialog>
    <mat-dialog-content class="dialog-content" align="center">
      <form class="form" [formGroup]="form" (ngSubmit)="onSubmit()">
        <mat-form-field class="form-old">
            <mat-label>Old Password</mat-label>
            <input matInput type="password" placeholder="Ex. *****" formControlName="oldPassword">
            @if (form.get('oldPassword')?.hasError("required")) {
                <mat-error>Old password is required</mat-error>
              }
        </mat-form-field>

        <mat-form-field class="form-confirm">
            <mat-label>Confirm the password </mat-label>
            <input matInput  type="password" placeholder="Ex. *****" formControlName="confirmNewPassword">
            @if (form.get('confirmNewPassword')?.hasError("required")) {
                <mat-error>This field is required</mat-error>
              }
        </mat-form-field>

        <mat-form-field class="form-new">
            <mat-label>New Password</mat-label>
            <input matInput type="password" placeholder="Ex. ****** " formControlName="newPassword">
            @if (form.get('newPassword')?.hasError("required")) {
                <mat-error>A new password is required</mat-error>
              }
        </mat-form-field>
    </form>
  
      <mat-dialog-actions align="end" class="dialog-label">
        <button matDialogClose (click)="onSubmit()">Save</button>
        <button mat-flat-button matDialogClose >Cancel</button>
      </mat-dialog-actions>
    </mat-dialog-content>
</ng-template>